<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Detalles del genero</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
    </style>
    <link rel="stylesheet" href="./pagination.css">
</head>
<body>
    <h1>Detalles del genero</h1>

    <ul id="paginated-list"></ul>
    <div id="pagination-numbers"></div>

    <script>
        window.onload = async function () {
          const { genre, offset, limit } = getUrlParams();

          fetchMovieDetails(genre, offset, limit)
            .then((data) => {
              const list = document.getElementById("paginated-list");
              const results = data.results;
              for (let movie of results) {
                const movieElement = document.createElement("li");
                  movieElement.addEventListener('click', () => {
                      redirectToDetails(movie.title)
                  })
                movieElement.textContent = `Title: ${movie.title} Rating: ${movie.averageRating}`;

                list.appendChild(movieElement);
              }

              // create buttons
              createPagButtons(data.totalItems, offset, offset);
            })
            .catch((error) => {
              console.error("Error fetching genre details:", error);
              document.getElementById("genreMovies").textContent =
                "No se pudo cargar la informaciÃ³n del genero";
            });
        };

        function fetchMovieDetails(genre, offset, limit) {
            return fetch(`/api/genre-details?genre=${encodeURIComponent(genre)}&offset=${encodeURIComponent(offset)}&limit=${encodeURIComponent(limit)}`)
                .then(response => response.json())
        }

        function redirectToDetails(title) {
            window.location.href = `movieDetails.html?title=${encodeURIComponent(title)}`;
        }

    </script>
    <script src="./pagination.js"></script>
</body>
</html>
